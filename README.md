# EcoSim: Симуляция Экосистемы на Pygame

Этот код представляет собой симуляцию простой экосистемы с травоядными, хищниками, сменой дня и ночи, написанную на Python с использованием библиотеки Pygame.

## Оглавление

1.  [Обзор](#обзор)
2.  [Структура Кода](#структура-кода)
3.  [Классы](#классы)
    •   [Game](#game)
    •   [Ecosystem](#ecosystem)
    •   [Entity](#entity)
    •   [Herbivore](#herbivore)
    •   [Predator](#predator)
    •   [Food](#food)
    •   [Water](#water)
    •   [ResourceManager](#resourcemanager)
    •   [DayNightCycle](#daynightcycle)
4.  [Как Запустить](#как-запустить)
5.  [Управление](#управление)
6.  [Возможные Улучшения](#возможные-улучшения)

## 1. Обзор

Цель кода - создать простую, но расширяемую симуляцию, демонстрирующую базовые принципы взаимодействия в экосистеме. В симуляции присутствуют травоядные, хищники, еда, вода, и происходит смена дня и ночи. Пользователь может взаимодействовать с симуляцией, изменяя некоторые параметры и наблюдая за изменениями в экосистеме.

## 2. Структура Кода

Код организован в несколько классов, каждый из которых отвечает за определенную часть симуляции. Основные части:

•   **Pygame:** Используется для графики и ввода.
•   **`Ecosystem`:** Управляет сущностями (животными), ресурсами (едой, водой) и общими параметрами (карта, день/ночь).
•   **`Entity` (базовый класс):** Общие свойства и поведение для всех живых существ (позиция, скорость, здоровье, голод, жажда, размножение).
•   **`Herbivore` (травоядное):**  Поведение травоядных (поиск еды, воды, размножение).
•   **`Predator` (хищник):** Поведение хищников (охота, еда, размножение).
•   **`Food` и `Water`:** Классы для представления еды и воды.
•   **ResourceManager:** управляет и оптимизирует загрузку ресурсов.
•   **`DayNightCycle`:** Управляет сменой дня и ночи, изменяет цвет фона.
•   **`Game`:**  Основной класс, инициализирует игру, обрабатывает ввод, обновляет состояние, отрисовывает всё на экране.

## 3. Классы

### Game

Основной класс, управляющий игрой.

•   **Атрибуты:**
    •   `width`, `height`: Размеры окна игры.
    •   `screen`: Объект поверхности Pygame для отрисовки.
    •   `clock`: Объект Clock Pygame для управления FPS.
    •   `is_running`: Флаг, указывающий, запущена ли игра.
    •   `ecosystem`: Экземпляр класса `Ecosystem`, содержащий данные об экосистеме.
    •   `debug_font`: Шрифт для отладочной информации.
    •   `fps`: Текущий FPS.

    *   `show_entity_info`: Флаг для отображения информации о сущностях.
    *   `is_paused`: Флаг, указывающий на состояние паузы.

*   **Методы:**
    *   `__init__(self, width, height)`: Инициализация игры.
    *   `create_initial_entities(self)`: Создание начальных сущностей (травоядных, хищников).
    *   `create_initial_resources(self)`: Создание начальных ресурсов (еды).
    *   `create_initial_water_sources(self)`: Создание начальных источников воды.
    *   `handle_input(self)`: Обработка ввода пользователя.
    *   `update(self, dt)`: Обновление состояния игры.
    *   `draw(self)`: Отрисовка игры на экране.
    *   `run(self)`: Запуск основного цикла игры.

### Ecosystem

Контейнер для всех сущностей и ресурсов.

*   **Атрибуты:**
    *   `entities`: Список всех сущностей (животных).
    *   `resources`: Список всех ресурсов (еды).
    *   `water_sources`: Список всех источников воды.
    *   `map`: Экземпляр класса `Map`, представляющий карту.
    *   `day_night_cycle`: Экземпляр класса `DayNightCycle`, управляющий сменой дня и ночи.

*   **Методы:**
    *   `add_entity(self, entity)`: Добавление сущности в экосистему.
    *   `remove_entity(self, entity)`: Удаление сущности из экосистемы.
    *   `add_resource(self, resource)`: Добавление ресурса в экосистему.
    *   `remove_resource(self, resource)`: Удаление ресурса из экосистемы.
    *   `add_water_source(self, water)`: Добавление источника воды в экосистему.
    *   `remove_water_source(self, water)`: Удаление источника воды из экосистемы.

### Entity

Базовый класс для всех сущностей в экосистеме.

*   **Атрибуты:**
    *   `position`: Вектор позиции сущности на карте.
    *   `speed`: Скорость движения.
    *   `size`: Размер сущности.
    *   `health`: Здоровье сущности.
    *   `hunger`: Уровень голода.
    *   `thirst`: Уровень жажды.
    *   `color`: Цвет сущности для отрисовки.
    *   `target`: Цель, к которой движется сущность (еда, вода, партнер для размножения).
    *   `reproductive_drive`:  Накопленная готовность к размножению
    *   `reproductive_ready`: Готова ли сущность к размножению
    *   `age`: Возраст
    *   `max_age`: Максимальный возраст
    *   `rect`: Rect для обнаружения столкновений.

*   **Методы:**
    *   `update(self, dt, ecosystem)`: Обновление состояния сущности.
    *   `check_for_food_and_water(self, dt, ecosystem)`: Проверка, нуждается ли сущность в еде или воде, и установка цели для поиска.
    *   `avoid_other_entities(self, dt, entities, is_day)`: Избегание столкновений с другими сущностями.
    *   `avoid_edges(self, map_obj)`: Избегание выхода за границы карты.
    *   `wander(self, dt, map_obj)`: Беспорядочное движение по карте.
    *   `on_target_reached(self, ecosystem)`: Действия при достижении цели.
    *   `draw(self, screen)`: Отрисовка сущности на экране.
    *   `draw_info(self, screen)`: Отрисовка информации о сущности на экране.
    *   `find_reproduction_target(self, entities)`: Поиск партнера для размножения.
    *   `find_water_target(self, water_sources)`: Поиск ближайшего источника воды.
    *   `find_nearest(self, items)`: Поиск ближайшего объекта из списка.

### Herbivore

Класс, представляющий травоядное животное.

*   Наследует от `Entity`.
*   Содержит логику поиска еды, воды и размножения.

### Predator

Класс, представляющий хищное животное.

*   Наследует от `Entity`.
*   Содержит логику охоты, поедания травоядных и размножения.

### Food

Класс, представляющий ресурс пищи.

*   **Атрибуты:**
    *   `x`, `y`: Координаты еды.
    *   `size`: Размер.
    *   `color`: Цвет.

*   **Метод:**
    *   `draw(self, screen)`: Отрисовка еды на экране.

### Water

Класс, представляющий источник воды.

*   *
 
*Атрибуты:**
    *   `x`, `y`: Координаты источника воды.
    *   `size`: Размер.
    *   `color`: Цвет.

*   **Метод:**
    *   `draw(self, screen)`: Отрисовка источника воды на экране.

### ResourceManager

Управление ресурсами (музыка, изображения).

*   **Атрибуты:**
    *   `sounds`: словарь для хранения загруженных звуков
    *   `images`: словарь для хранения загруженных изображений
*   **Методы:**
    *   `load_sound(self, name, path)`: загружает звук по имени
    *   `load_image(self, name, path)`: загружает изображение по имени

### DayNightCycle

Класс, управляющий сменой дня и ночи.

*   **Атрибуты:**
    *   `day_length`: Длина дня в циклах.
    *   `night_length`: Длина ночи в циклах.
    *   `transition_duration`: Длительность перехода между днем и ночью.
    *   `timer`: Текущее время в цикле.
    *   `time_scale`: Масштаб времени (для ускорения или замедления).

*   **Методы:**
    *   `update(self, dt)`: Обновление состояния цикла дня и ночи.
    *   `get_time_progress(self)`: Получение прогресса текущего времени дня.
    *   `is_day(self)`: Проверка, является ли текущее время днем.
    *   `get_background_color(self)`: Получение цвета фона в зависимости от времени суток.

## 4. Как Запустить

1.  Убедитесь, что у вас установлен Python 3.
2.  Установите библиотеку Pygame: `pip install pygame`
3.  Сохраните код в файл с расширением `.py`, например, `ecosim.py`.
4.  Запустите файл из командной строки: `python ecosim.py`.

## 5. Управление

*   **`P`:** Пауза/Возобновление игры.
*   **`F`:** Создать новую еду.
*   **`+` (Плюс):** Ускорить смену дня и ночи.
*   **`-` (Минус):** Замедлить смену дня и ночи.
*   **`1`:** Вернуть нормальную скорость смены дня и ночи.
*   **`SPACE`:** Показать/скрыть информацию о сущностях.

## 6. Возможные Улучшения

*   **Более сложная логика поведения животных:** Улучшить алгоритмы поиска еды, воды, партнеров для размножения. Добавить факторы, влияющие на принятие решений (страх, усталость и т.д.).
*   **Разнообразие ресурсов:** Добавить разные типы еды и воды с разными свойствами.
*   **Мутации и эволюция:** Ввести мутации в геном животных, влияющие на их свойства.
*   **Взаимодействие с пользователем:** Добавить больше возможностей для взаимодействия с симуляцией (например, изменение ландшафта, добавление новых животных).
*   **Улучшенная графика:** Использовать более реалистичную графику и анимацию.
*   **Звуковое сопровождение:** Добавить звуковые эффекты и музыку.
*   **Реалистичная карта:** Добавить генерацию карты, биомы и логику ландшафта.
## Инструкция по запуску:

1.  **Клонирование репозитория:**
    Если вы ещё не клонировали репозиторий, используйте Git для клонирования на ваш локальную машину:
    ```
    git clone <ссылка_на_репозиторий>
    ```
    
Замените **<ссылка_на_репозиторий>** на фактическую ссылку на мой репозиторий.

2.  **Установка зависимостей:**
    Откройте терминал, перейдите в директорию проекта и установите необходимые библиотеки:
    ```
    pip install pygame
    ```
3.  **Запуск бота:**
    В терминале, находясь в директории проекта, запустите скрипт main.py:
    `python main.py`
    ```
    python3 main.py
    ```
